# Оценка риска ДТП

[Ссылка на nbviewer, если GitHub не прогружает тетрадку](https://nbviewer.org/github/IgumnovAnton/Yandex_Projects/blob/main/Car_crash/car_crash.ipynb)

## **Info**
Необходимо создать систему, которая могла бы оценить риск ДТП по выбранному маршруту движения. 

Под риском понимается вероятность ДТП с любым повреждением транспортного средства. 

Как только водитель забронировал автомобиль, сел за руль и выбрал маршрут, система должна оценить уровень риска. 

Если уровень риска высок, водитель увидит предупреждение и рекомендации по маршруту. 

**Цель:**
- создать модель предсказания ДТП
- определить основные факторы ДТП
- сформировать задачи для коллег (решить их самому, для примера)
- оценить возможно ли создать адекватную систему оценки риска
- предложить варианты контроля/штрафов

**Метрика:**
- метрика для оценки качества модели ROC AUC

**Точность:**
- Необходимая точность метрики в данной задаче не установлена


## **Data**

Данные были предоставленны Яндексом для образовательных целей. 
Таблицы представляет из себя исторические данные о ДТП.

**Красткое описание таблиц**

- **`collisions`** — общая информация о ДТП
Имеет уникальный `case_id`. Эта таблица описывает общую информацию о ДТП. Например, где оно произошло и когда.

- **`parties`** — информация об участниках ДТП
Имеет неуникальный `case_id`, который сопоставляется с соответствующим ДТП в таблице `collisions`. 

    Каждая строка здесь описывает одну из сторон, участвующих в ДТП. Если столкнулись две машины, в этой таблице должно быть две строки с совпадением `case_id`. 

    Если нужен уникальный идентификатор, это `case_id` and `party_number`.

- **`vehicles`** — информация о пострадавших машинах
Имеет неуникальные `case_id` и неуникальные `party_number`, которые сопоставляются с таблицей `collisions` и таблицей `parties`. 

    Если нужен уникальный идентификатор, это `case_id` and `party_number`.

## **Analysis** 

При осмотре данных обнаружено:

- Данные есть во всех таблицах
- `case_id` есть во всех таблицах
- в `case_id` нет пропусков, что хорошо для объединения таблиц
- в некоторых таблицах есть пропуски, при дальнейшем анализе оценю необходимость их заполнения
- нам предоставили 1 400 000 случаев дтп для анализа и работы

## **Features** 

Для создания модели были отобраны основные фичи из общей базы.

Сформировал датасет на основании запроса "заказчика"

Нулевые значения были отброшены

Сформированный датасет имеет размерность: 103862 строк × 13 колонок

## **Modeling and Testing**

Для обучения и предсказания использовались CatBoost, RandomForest, LogReg

ROC AUC выбранных моделей получился:

| CatBoost | RandomForest | LogReg |
|:---:|:---:|:---:|
| 0.77 | 0.70 | 0.70 |

## **Conclusion**

CatBoost оказался самым точным

Найдена основная причина аварий:
- превышение скорости, но при этом НЕ в состоянии алкогольного опьянения) Что странно) обычно одно является следствием другого.

Способ борьбы со скоростью уже изобретен) Камеры и высокие штрафы. Уверен, что статистика в 2022 году будет совершенно другая) В 2012 году камер не было (или были единицы). 

Варианты решения:

- Включить звуковое оповещение о превышении скорости
- Включить физическое ограничение скорости на автомобиле в зависимости от типа дороги и разрешенной скорости на ней
- Внедрить систему наказаний/штрафования водителей каршеринга вплоть до блокировки аккаунта





