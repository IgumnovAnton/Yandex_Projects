# Предсказание стоимости жилья

[Ссылка на nbviewer, если GitHub не прогружает тетрадку](https://nbviewer.org/github/IgumnovAnton/Yandex_Projects/blob/main/House_prices/house_prices.ipynb)

## **Info**
Имеется датасет с информацией о жилье в Калифорнии в 1990 году.
На основе данных нужно предсказать медианную стоимость дома в жилом массиве. 

**Цель:**
- используя Spark и MLlib создать модель для предсказания цены

**Метрика:**
- метрики для оценки качества модели **RMSE**, **MAE**, **R2**

**Точность:**
- для данной задачи порог метрики не был обозначен


## **Data**

Данные были предоставленны Яндексом для образовательных целей. 
Таблица представляет из себя данные о жилье в Калифорнии в 1990 году.

Таблица `housing.csv` - 20640 строк и 10 колонок

- `longitude` - широта
- `latitude` - долгота
- `housing_median_age` - медианный возраст жителей жилого массива
- `total_rooms` - общее количество комнат в домах жилого массива
- `total_bedrooms` - общее количество спален в домах жилого массива
- `population` - количество человек, которые проживают в жилом массиве
- `households` - количество домовладений в жилом массиве
- `median_income` - медианный доход жителей жилого массива
- `median_house_value` - медианная стоимость дома в жилом массиве
- `ocean_proximity` - близость к океану

## **Analysis** 

При осмотре данных обнаружено:

- Имееются пропуски в колонке `total_bedrooms`
- В некоторых колонках очень большой разброс между минимальным и максимальным значениями
- 1 колонка с категориальными признаками и 9 с числовыми признаками

## **Features** 

Тк данных мало, то решил заполнить пропуски медианным значением по колонке

К категориальным фичам была применен способ ОНЕ
Числовые фичи отскалировали, чтобы сгладить расброс


## **Modeling and Testing**

Для решения задачи была обозначена модель Линейной Регрессии
Был использован модуль MLlib для обучения и предсказания

Для разработки было применено два способа обучения:
- на всех данных
- только на числовых данных

**На всех данных**

| RMSE | MAE | R2 |
|:---:|:---:|:---:|
| 69035 | 49651 | 0.66 |

**На числовых данных**

| RMSE | MAE | R2 |
|:---:|:---:|:---:|
| 70077 | 50991 | 0.65 |


## **Conclusion**

Используя Spark и MLlib создали модель для предсказания медианной цены в жилом массиве.

- Были обучены два варианта моделей:
    - С полным набором фичей
    - Только с численными фичами
- Модель, обученная на полном наборе данных показала более точный результат:
    - Значение R2 выше
    - Значения RMSE и MAE ниже





