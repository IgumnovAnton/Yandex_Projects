# Прогнозирование заказов такси

[Ссылка на nbviewer, если GitHub не прогружает тетрадку](https://nbviewer.org/github/IgumnovAnton/Yandex_Projects/blob/main/Taxi_Project/taxi_project.ipynb)

## **Info**
Оператор сервиса Такси хочет уметь прогнозировать **объем заказов**

Основываясь на этих прогнозах, будут распределяться заказы между таксистами и определяться нагрузка на сервис в течении дня.


**Цель:**
- создать модель прогнозирования количества заказов такси на следующий час

**Метрика:**
- метрика для оценки качества модели RMSE

**Точность:**
- RMSE лучшей модели должен быть не больше **48**


## **Data**

Данные были предоставленны Яндексом для образовательных целей. 
Таблица представляет из себя набор исторических данных заказов такси в аэропортах.

Таблица `taxi.csv` - 4416 строк и 2 колонки

## **Analysis** 

Информация представлена за 2018 год, в промежуток между мартом и августом.
В данных отсутствуют пропуски.
Проведена проверка сезонности и тренда заказов.
К концу лета наблюдается тренд увеличения количества заказов к августу.
Для выявления сезонных колебаний оценил недельный и днеыной срез. Недельный срез не выявил сезонных трендов. Дневной срез показал активность утром, в полночь и во время обеда.

## **Features** 

Для обогащения датасета была написана функция для генерации дополнительных столбцов. Добавляет колонки со сдвигом в год, месяц, неделю и день недели. Так же добавили скользящее среднее по выбранному окну.


## **Modeling**

Для оценки адекватности создали константную модель.

В работе, для поиска лучшей модели, были использованы: LinearRegression, Ridge, ElasticNet, Lars, Lasso
Так же, ради эксперемента, использовал XGBoost.

Результаты на валидационной выборке:

| XGB | RIDGE_RS | LASSO_RS | EN_RS | ENet | LASSO | LR | RIDGE | RF | RF_RS | LARS_RS | LARS |
|:------:|:-------:|:------:|:-------:|:------:|:-------:|:------:|:-------:|:------:|:-------:|:------:|:-------:|
| 30.716 | 31.143 | 31.183 | 31.188 | 31.195 | 31.219 | 31.244 | 31.261 | 31.365 | 32.054 | 36.159 | 44.353 |

## **Model testing and Conclusion**

Изначальный датасет снова был разделен на трейн и тест.
Тестовая выборка составляет 10% от изначальной.
На новой выборке зафитили лучшую модель и проверили на тесте.

| XGB |
|:---:|
| 43.21 |

Модель предсказывает лучше поставленной цели:
- значение RMSE < 48


